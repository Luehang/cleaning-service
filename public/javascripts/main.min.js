"use strict";var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}return function(e,i,s){return i&&t(e.prototype,i),s&&t(e,s),e}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var settings={spotlightRadius:400,boxCount:50,moveSpeed:1,turboSpeed:5};function state(t){if("init"===t){var e=new Application,i=document.querySelector("#game-wrapper");i.addEventListener("mousemove",function(t){e.universe.light.position.x=t.clientX*window.devicePixelRatio,e.universe.light.position.y=t.clientY*window.devicePixelRatio}),i.addEventListener("mousedown",function(){e.universe.speed=settings.turboSpeed}),i.addEventListener("mouseup",function(){e.universe.speed=settings.moveSpeed})}}var Application=function(){function t(){var e=this;_classCallCheck(this,t),this.width=null,this.height=null;var i=document.querySelector("#game-wrapper");this.canvas=document.createElement("canvas"),i.appendChild(this.canvas),this.context=this.canvas.getContext("2d"),this.canvasOverlay=document.createElement("canvas"),i.appendChild(this.canvasOverlay),this.contextOverlay=this.canvasOverlay.getContext("2d"),this.resize(),window.addEventListener("resize",function(){return e.resize()},!1),this.universe=new Universe(this.width,this.height),this.render()}return _createClass(t,[{key:"render",value:function(){var t=this;this.context.clearRect(0,0,this.width*window.devicePixelRatio,this.height*window.devicePixelRatio);var e=this.context.createRadialGradient(this.universe.light.position.x,this.universe.light.position.y,.9*settings.spotlightRadius,this.universe.light.position.x,this.universe.light.position.y,0);e.addColorStop(0,"#202062"),e.addColorStop(1,"#988280"),this.context.fillStyle=e,this.context.fillRect(0,0,this.width,this.height);for(var i=this.universe.boxArray,s=0;s<i.length;s++){var o=i[s];this.context.fillStyle=o.color,this.context.strokeStyle=o.color;for(var n=0;n<o.shadowCorners.length;n++){var a=n<o.shadowCorners.length-1?n+1:0;this.context.beginPath(),this.context.moveTo(o.corners[n].x,o.corners[n].y),this.context.lineTo(o.shadowCorners[n].x,o.shadowCorners[n].y),this.context.lineTo(o.shadowCorners[a].x,o.shadowCorners[a].y),this.context.lineTo(o.corners[a].x,o.corners[a].y),this.context.closePath(),this.context.stroke(),this.context.fill()}this.context.beginPath(),this.context.moveTo(o.corners[0].x,o.corners[0].y);for(var r=1;r<o.sides;r++)this.context.lineTo(o.corners[r].x,o.corners[r].y);this.context.closePath(),this.context.fill(),this.context.stroke()}this.context.beginPath(),this.context.arc(this.universe.light.position.x,this.universe.light.position.y,2,0,2*Math.PI),this.context.stroke(),this.contextOverlay.clearRect(0,0,this.width*window.devicePixelRatio,this.height*window.devicePixelRatio),(e=this.contextOverlay.createRadialGradient(this.universe.light.position.x,this.universe.light.position.y,settings.spotlightRadius,this.universe.light.position.x,this.universe.light.position.y,0)).addColorStop(0,"#0a0e23"),e.addColorStop(.5,"transparent"),this.contextOverlay.fillStyle=e,this.contextOverlay.fillRect(0,0,this.width,this.height),this.update(),window.requestAnimationFrame(function(){return t.render()})}},{key:"update",value:function(){this.universe.update(this.center)}},{key:"resize",value:function(){this.width=window.innerWidth,this.height=window.innerHeight,document.querySelector("#game-wrapper").style.width=this.width+"px",document.querySelector("#game-wrapper").style.height="85vh",this.width*=window.devicePixelRatio,this.height*=window.devicePixelRatio,this.canvas.width=this.width,this.canvas.height=this.height,this.canvasOverlay.width=this.width,this.canvasOverlay.height=this.height,this.universe&&this.universe.generateBoxes(),this.context.globalCompositeOperation="screen",this.center={x:this.width/2,y:this.height/2}}}]),t}(),Universe=function(){function t(e,i){_classCallCheck(this,t),this.width=e,this.height=i,this.speed=settings.moveSpeed,this.boxArray=[],this.generateBoxes(),this.light=new Light(.75*e,.35*i)}return _createClass(t,[{key:"generateBoxes",value:function(){this.boxArray=[];for(var t=0;t<settings.boxCount;t++){var e=new Box(this.width,this.height);this.boxArray.push(e)}}},{key:"update",value:function(t){var e=this,i=(t.x-this.light.position.x)/100,s=(t.y-this.light.position.y)/100;Array.prototype.forEach.call(this.boxArray,function(o){o.update(t,i*e.speed,s*e.speed,e.light)})}}]),t}(),Box=function(){function t(e,i){_classCallCheck(this,t),this.position={x:Math.random()*e,y:Math.random()*i},this.radius=30*Math.random(),this.rotation=Math.random(),this.rotationSpeed=(Math.random()-.5)/100,this.sides=Math.floor(6*Math.random()+3),this.color=this.getRandomColor(),this.corners=[],this.getCornerLocations(),this.shadowCorners=this.corners}return _createClass(t,[{key:"update",value:function(t,e,i,s){this.position.x+=e,this.position.y+=i,this.position.x<-this.radius?this.position.x+=2*t.x+2*this.radius:this.position.x>2*t.x+this.radius&&(this.position.x-=2*t.x+2*this.radius),this.position.y<0-this.radius?this.position.y+=2*t.y+2*this.radius:this.position.y>2*t.y+this.radius&&(this.position.y-=2*t.y+2*this.radius),this.rotation+=this.rotationSpeed,this.corners=[],this.shadowCorners=[],this.getCornerLocations(),this.getShadowCorners(s)}},{key:"getCornerLocations",value:function(){for(var t=2*Math.PI/this.sides,e=0;e<this.sides;e++){var i=this.position.x+this.radius*Math.sin(this.rotation+e*t),s=this.position.y+this.radius*Math.cos(this.rotation+e*t);this.corners.push({x:i,y:s})}}},{key:"getShadowCorners",value:function(t){for(var e=0;e<this.sides;e++){var i=this.corners[e].x-t.position.x,s=this.corners[e].y-t.position.y,o=Math.sqrt(i*i+s*s),n=t.position.x+i*settings.spotlightRadius/o*20,a=t.position.y+s*settings.spotlightRadius/o*20;this.shadowCorners.push({x:n,y:a})}}},{key:"getRandomColor",value:function(){for(var t="#",e=0;e<6;e++)t+="0123456789ABCDEF"[Math.floor(16*Math.random())];return t}}]),t}(),Light=function t(e,i){_classCallCheck(this,t),this.position={x:e,y:i}};window.onload=function(){state("init")};var quoteForm=document.getElementById("quote-form"),quoteButton=document.getElementById("submit-quote"),quoteName=document.getElementById("first_name"),$quoteLast=$("#last_name"),quoteEmail=document.getElementById("email"),$quotePhone=$("#phone_number"),$quoteCompany=$("#company"),$quoteCity=$("#city"),$quoteState=$("#state"),$quoteComments=$("#comments"),$alert=$("#alert"),$annotation=$("#front-annotation");function validateEmail(t){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(t.toLowerCase())}$(".annotation-content .close").click(function(){$(".annotation-content").css("display","none")}),quoteButton.addEventListener("click",function(t){var e=[],i="";""==quoteName.value&&e.push("First name needs to be filled out."),!1===validateEmail(quoteEmail.value)&&e.push("Invalid E-mail Address."),0!==e.length?(e.map(function(t){i+='<p style="color: red;">* '+t+"</p>"}),document.getElementById("alert").innerHTML=i,document.getElementById("front-annotation").style.display="block"):(t.preventDefault(),$.ajax({type:"POST",url:"/api/get-quote",data:{first_name:quoteName.value,last_name:$quoteLast.val(),email:quoteEmail.value,phone_number:$quotePhone.val(),company:$quoteCompany.val(),city:$quoteCity.val(),state:$quoteState.val(),comments:$quoteComments.val()},dataType:"json",cache:!0}).done(function(t){t.success?($alert.html('<p style="color: green;">'+t.message+"</p>"),$annotation.css("display","block")):!1===t.success?($alert.html('<p style="color: red;">* '+t.message+"</p>"),$annotation.css("display","block")):($alert.html('<p style="color: red;">* Message was not sent successfully.  Please try again.</p>'),$annotation.css("display","block"))}).fail(function(){$alert.html('<p style="color: red;">* Message was not sent successfully.  Please try again.</p>'),$annotation.css("display","block")}))});